
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>一个简单的j2ee入门教程（第二部分——设计） - 刘江华的博客</title>
  <meta name="author" content="冰雨">

  
  <meta name="description" content="&emsp;&emsp;原型实现 &emsp;&emsp;接下来的一步是要将原型设计阶段的草图，实现为可重用的界面原型，本例中我们用DW(Dreamweaver简写)进行实现。 界面原型目录结构图 &emsp;&emsp;在进行原型实现的时候一定要注意下面的一些事项： &emsp;&emsp;1、 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yanyaner.com/blog/2010/12/17/jeee-tou-2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="刘江华的博客" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">刘江华的博客</a></h1>
  
    <h2>众里寻她千百度，蓦然回首，那人却在，灯火阑珊处......</h2>
  
</hgroup>

</header>
  <article class="my_clear"><img src="/images/commons/banner.jpg" class="my_clear"></img></article>
  <nav role="navigation">
  
<ul class="main-navigation">
  <li><a href="/">博客文章</a></li>
  <li><a href="/blog/archives">全部文章</a></li>
  <li><a href="/blog/categories/hui-hua-zuo-pin">我的作品</a></li>
  <li><a href="/about">关于我</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">一个简单的j2ee入门教程（第二部分——设计）</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-17T15:18:00+08:00" pubdate data-updated="true">2010年12月17日</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>&emsp;&emsp;<strong>原型实现</strong></p>

<p>&emsp;&emsp;接下来的一步是要将原型设计阶段的草图，实现为可重用的界面原型，本例中我们用DW(Dreamweaver简写)进行实现。</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/50.png' width='' height='' title='界面原型目录结构图'><span class='caption-text'>界面原型目录结构图</span></span></p>

<p>&emsp;&emsp;在进行原型实现的时候一定要注意下面的一些事项：</p>

<p>&emsp;&emsp;1、目录结构</p>

<p>&emsp;&emsp;子模块页面要建上当分类存放；images图片要有专门文件夹；js、css要要有专门文件夹；如果用户可以上传文件，还得规划相应的目录。</p>

<p>&emsp;&emsp;2、文件命名方式</p>

<p>&emsp;&emsp;原则是见名知意，请参考我上面截图中我的命名方式，你就会明白。</p>

<p>&emsp;&emsp;3、页面中输入框的命名，元素的命名</p>

<p>&emsp;&emsp;原则是要考虑到域对象中一些属性的命名，以方便后期实现</p>

<p>&emsp;&emsp;4、css、js</p>

<p>&emsp;&emsp;尽量将页面的表现与行为分离到单独的文件中</p>

<p>&emsp;&emsp;页面实现阶段要考虑的东西真的非常多，包括界面风格，seo，用户体验等等。因为页面是很多程序员不屑一顾的，甚至有人认为这完全是美工的事，这些想法都是完全错误的。</p>

<p>&emsp;&emsp;原型实现一定要认真、细致，因为这个原型是后面项目中可重要的原型哦，在这里下的功夫到位了，后期的实现时会节省很多时间。</p>

<p>&emsp;&emsp;当然原型的实现也可以放到后期来做（比如详细设计时，编码前期），但建议还是提前，因为原型对完善领域对象的属性有很大的作用。</p>

<p>&emsp;&emsp;下面来说一说设计阶段的主要活动。</p>

<p>&emsp;&emsp;设计阶段分为概要设计和详细设计两个步骤，根据我们的业务需求，先进行概要设计。概要设计要做的事情包括：进一步明确、完善领域模型；确定系统业务架构；确定系统技术架构等。</p>

<p>&emsp;&emsp;<strong>概要设计</strong></p>

<p>&emsp;&emsp;首先要知道为什么概要设计要在需求分析完成后才开始，这个也是很多新手不太明白的。原因在于需求中有很多非功能性需求（约束）对项目的成败影响非常大，这些非功能性需求会在需求分析说明书中进行描述，概要设计就是要根据这些具体需求来确定系统架构，以从整体上满足系统非功能性需求。</p>

<p>&emsp;&emsp;架构又分为业务架构和系统技术架构，系统的业务架构一般会根据很多个类似项目或相近领域项目的开发经验、积累，进行总结提炼后方可行成，比如：权限管理、工作流程管理、税率算法等等，这些业务架构可以在未来的新项目中得以重用，换句话说，新项目可以架构在现有的业务架构之上而不需从零开始。本示例过于简单，中我们没有办法抽取业务架构，固本步骤略去。</p>

<p>&emsp;&emsp;系统技术架构是一定需要的，根据需求选择相应的技术架构，进行简单封装并制定一套开发的规范非常的重要，因为好的技术架构会减少程序员的工作量，提高开发效率。技术架构会根据需求（主要是非功能性需求）来确定，比如：遗留项目二次开发、对系统查询性能要求很高的项目、高并发访问项目，账务项目、军工项目等等，不同的项目类型及项目需求，都可能设计出来不同的技术架构。本示例中，我还是采用最常见的ssh技术架构，业务逻辑采用事务脚本方式封装，下面按分层来分别介绍各个层次在概要设计的决策（架构就是由一系列的决策组成）。</p>

<p>&emsp;&emsp;一、表现层</p>

<p>&emsp;&emsp;表现层的开发会占到编码80%左右的周期，因此表现层的技术、框架的选择是非常的重要，开发效率、可维护性是一个选择的指标，在选择时要多做比较。</p>

<p>&emsp;&emsp;需求：项目中会有大量的js操作——>决策：引入jQuery提高开发效率，并下载jQuery扩展插件进一步减少程序员工作量。</p>

<p>&emsp;&emsp;需求：项目工期紧，表现层交互开发周期紧张——>决策：用struts2提高开发效率（示例中我也会给出struts1.x或servlet的实现注意事项，但struts2确实会简化我们的程序开发）。</p>

<p>&emsp;&emsp;二、业务层</p>

<p>&emsp;&emsp;需求：开发人员更熟悉面向过程，项目后续维护期很长——>决策：采用事务脚本封装业务逻辑，界面可直接映射到业务方法。</p>

<p>&emsp;&emsp;需求：所有业务都需要事务处理；决策：事务交spring管理——>为了业务方法设计的灵活性，采用spring注解方式声明事务。</p>

<p>&emsp;&emsp;再考虑一下业务层数据持久化问题。在本例中，业务实现类中需要聚合一个IBaseDao以完成对象的持久化操作，这种持久层框架设计采用了我在另一篇文章《持久层设计方案总结》中的第二种，业务实现类与持久化类的关系如下图所示：</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/41.png' width='' height='' title='学生系统业务层设计图'><span class='caption-text'>学生系统业务层设计图</span></span></p>

<p>&emsp;&emsp;我们在StudnetServiceImpl中聚合IBaseDao完成对象持久化操作，由于IBaseDao是一个通用持久接口，因此，在业务实现类中不可避免会写上很多sql或HQL等，看上去这些代码和数据库相关性很大，如果你认为这种方式不好（似乎职责划分不明确），也可以稍加改进，变成《持久层设计方案总结》中最后一种方案。但你要知道这种方式是软件公司中常用的一种方式，开发的效率较高效，可维护性较好。</p>

<p>&emsp;&emsp;三、持久层</p>

<p>&emsp;&emsp;需求：本系统是全新设计开发（非遗留系统的二次开发）——>决定：使用hibernate作为持久层orm框架。</p>

<p>&emsp;&emsp;需求：业务中基本的CRUD操作非常多——>决定：封装通用持久层。</p>

<p>&emsp;&emsp;通用的dao操作如下设计如下（与hibernate有一定的耦合，当然可以设计出更好的通用方法，但我认为一个项目的持久层技术框架确定后，一般很少有更换的情况，因此，这种耦合是稳定的）：</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/42.png' width='' height='' title='学生系统业务层设计图'><span class='caption-text'>学生系统业务层设计图</span></span></p>

<p>&emsp;&emsp;至此，概要设计基本完成，《概要设计说明书》会就是我们的一个标志性文档。我们整体软件开发是一个增量、迭代的过程，我们对业务的理解也会逐渐深入，对领域模型也会调整得更加的准确（域模型就是对业务理解的固化），《概要设计说明》将为详细设计提供指导和依据。</p>

<p>&emsp;&emsp;<strong>详细设计</strong></p>

<p>&emsp;&emsp;紧接着我们马上要进入编码阶段了，但仅仅有概要设计的成果我们还无法开展工作，比如：系统中有哪些具体包，哪些类（由于很多类在领域模型中是没有的，但是编码阶段又是必须要用的）等等，详细设计就是要解决这些问题，把一些更细节的东西确定下来。详细设计阶段要解决下面一些问题：</p>

<p>&emsp;&emsp;A、进一步确定领域对象之间的关系，并完善属性</p>

<p>&emsp;&emsp;在概要设计阶段的领域模型图中，可能标注了对象之间的关系以及数量，但在详细设计阶段需要对这些关系进行进一步的明确，特别是一对多，一对一的方向性问题，我已经在《领域对象的关联设计》一文中有详细论述，由于我们的示例中只有一个对象，所以这个过程就可以简化了。</p>

<p>&emsp;&emsp;领域对象的属性，要得根据原型来，在详细设计阶段，原型应该已经实现完成，找到和域对象相关的界面原型，根据原型的界面元素，完善领域对象的属性，其实，从原型上也可以进一步验证领域对象关系是否合理。宅急送后的领域对象如下图，注意属性要全部准确翻译成英文，中文注释一定要写上。</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/39.png' width='' height='' title='完善属性'><span class='caption-text'>完善属性</span></span></p>

<p>&emsp;&emsp;B、数据字典及数据库建表sql语句</p>

<p>&emsp;&emsp;有人由hbm文件反向生成表结构，并设置hbm2ddl参数为true实现表结构的自动更新，这种做法是开发经验不丰富的表现。虽然现在领域驱动设计（DDD），OOAD等的口号喊得很响，但在实际应用中还得必须以数据为中心，而数据往往又是关系型数据库，关系数据和对象间存在阻抗、不匹配性，而最后在压力测试时关系数据库又是90%的性能瓶颈所在，因此，对系统的数据存储进行设计就显得非常的有必要，生成一份详细的《数据字典》，无论对于开发阶段，还是维护阶段来说都有重大意义。</p>

<p>&emsp;&emsp;我们这里使用PD（Powerdesigner简写）进行数据库设计，先建立概念模型，再由概念模型生成物理模型。概念模型建立后，你会发现建立的概念模型和领域模型非常的相似，似乎建立概念模型是一项重复性的工作，我以前也是这么认为的，但在经历过一些项目后，我明白了其中的原因：概念模型可以转成各种不同数据库系统的物理模型，这将为系统更换数据库系统带来方便。下面是本示例的概念模型，要注意的是实体中的 name和code两个字段的含义，name一般填入中文，code为最终导出代码（脚本）时用的名称。</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/43.png' width='' height='' title='学生系统概念模型图'><span class='caption-text'>学生系统概念模型图</span></span></p>

<p>&emsp;&emsp;将上面的概念模型转成物理模型，如下图（这个时候就要选择底层的数据库类型了哦，这里我选择mysql5）。物理模型要由手工再逐一核对修改一遍，确保其正确性。</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/40.png' width='' height='' title='学生系统物理模型图'><span class='caption-text'>学生系统物理模型图</span></span></p>

<p>&emsp;&emsp;最后，由物理模型导出数据字典，我用PDMReader导出数据字典，PDMReader是一个免费工具，网上google一下就可以下载，得到的数据字典如下：</p>

<p><span class='caption-wrapper'><img class='caption' src='/uploads/2011/03/44.png' width='' height='' title='学生系统数据字典'><span class='caption-text'>学生系统数据字典</span></span></p>

<p>&emsp;&emsp;当然，也可以在PD中直接导出文档，但我认为PD中导出的文档太复杂，有点华而不实，不如PDMReader来得简单。</p>

<p>&emsp;&emsp;最后强调一下表和字段的命名规范，你在填写code的时候，就按这个规则去命名。</p>

<p>&emsp;&emsp;表：t<em>表名，如果是中间表：t</em>表名1_表名2</p>

<p>&emsp;&emsp;字段：f_字段名</p>

<p>&emsp;&emsp;主键：pk_主键名</p>

<p>&emsp;&emsp;外键：fk<em>表名</em>外键字段名</p>

<p>&emsp;&emsp;索引：idx_索引字段名</p>

<p>&emsp;&emsp;《数据字典》是一份非常重要的文档，给它取一个版本号，后期一定会有修改的，版本号要跟着调整。</p>

<p>&emsp;&emsp;C、完成业务层方法的设计，完成其它包层次中的类设计，比如：action编码前要由uml工具导出代码，将导出的代码放入项目初始版本。因此业务方法要根据界面原型来进行详细的设计，如果业务类设计得完整、合理，编码时就会顺利得多。</p>

<p>&emsp;&emsp;当然，不要期待能够把业务层方法设计得非常完善，我们在后续的迭代过程中也会以添加一些没有考虑到的方法。详细设计也得看详细到什么程度，如果你要像日本外包那样来做详细设计，那么action等一切都要设计好，甚至包括界面的像素布局、sql模板都要写好，我想，做为普通的软件公司特别是中小公司，还是要“敏捷”点为好。</p>

<p>&emsp;&emsp;设计阶段完成后，就该进行编码了，但编码前还有很多准备工作要做，这些内容我会在下一篇文章中详细说明。</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard"> <span class="fn">冰雨</span> 发表于 </span>

      








  


<time datetime="2010-12-17T15:18:00+08:00" pubdate data-updated="true">2010年12月17日</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>java</a>, <a class='category' href='/blog/categories/javaee/'>javaEE</a>, <a class='category' href='/blog/categories/ji-zhu/'>技术</a>
  
</span>


    </p>
    
      <!-- JiaThis Button BEGIN -->
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?move=0&amp;btn=r5.gif" charset="utf-8"></script>
<!-- JiaThis Button END 
<div class="sharing">
  
  
  
</div>-->

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2010/12/13/jeee-tou-1/" title="上一篇文章: 一个简单的j2ee入门教程（第一部分——需求分析 ）">&laquo;上一篇:&nbsp;&nbsp;一个简单的j2ee入门教程（第一部分——需求分析 ）</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/12/20/jeee-tou-3/" title="下一篇文章: 一个简单的j2ee入门教程（第三部分——编码前的准备）">下一篇: &nbsp;&nbsp;一个简单的j2ee入门教程（第三部分——编码前的准备） &raquo;</a>
      
    </p>
  </footer>
</article>


  <section>
    <h3>评论信息</h3>
    <div id="comments" aria-live="polite"><no<!-- Duoshuo Comment BEGIN -->
<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"ljh2008"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>
<!-- Duoshuo Comment END -->
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>最近文章</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/05/23/security6/">Java安全那些事之六（客户端安全）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/21/security5/">Java安全那些事之五（客户端安全）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/16/security4/">Java安全那些事之四（无状态安全认证）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/15/security3/">java安全那些事之三（RSA及https）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/14/security2/">Java安全那些事之二（base64,des）</a>
      </li>
    
  </ul>
</section>
<section>
   <h1>文章分类</h1>
   <ul id="categories">
     
		<li><a href="/blog/categories/sheng-huo">生活</a><a href="/blog/categories/yi-zhu">艺术</a></li>
		<li><a href="/blog/categories/ji-zhu">技术</a><a href="/blog/categories/jia-gou">架构</a></li>
		<li><a href="/blog/categories/java">java</a><a href="/blog/categories/javaee">javaEE</a></li>
		<li><a href="/blog/categories/qian-duan-ji-zhu">前端技术</a><a href="/blog/categories/nodejs">Node.js</a></li>
	    <li><a href="/blog/categories/bu-zou-jie-xi">步骤解析</a></li>
	 
   </ul>
</section>

<section>
  <h3></h3>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6635992117744268"
     data-ad-slot="8027050961"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</section>

<section>
<h1>最近评论</h1>
<ul class="ds-recent-comments" data-num-items="10">
</ul>
<!--多说js加载开始，一个页面只需要加载一次 -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"ljh2008"};
(function() {
var ds = document.createElement('script');
ds.type = 'text/javascript';
ds.async = true;ds.src = 'http://static.duoshuo.com/embed.js';
ds.charset = 'UTF-8';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!--多说js加载结束，一个页面只需要加载一次 -->
</section><section>
<h1>最近来访</h1>
<ul class="ds-recent-visitors" data-num-items="60">
</ul>
<script type="text/javascript">
var duoshuoQuery = {short_name:"ljh2008"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
</section>




  
</aside>



    </div>
  </div>
  <footer role="contentinfo"><p>
  版权所有 &copy; 2014 - 冰雨 -
  <span class="credit">Powered by <a href="http://yanyaner.com">刘江华的博客</a></span>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5742334'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5742334%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>
</p>

</footer>
  











</body>
</html>
